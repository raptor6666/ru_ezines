<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en"><head><script type="text/javascript" async="" src="%D0%90%D1%82%D0%B0%D0%BA%D0%B0%20%D0%BA%D0%BB%D0%BE%D0%BD%D0%BE%D0%B2.%20%D0%9E%D0%BC%D0%BE%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F%20%D0%B0%D1%82%D0%B0%D0%BA%D0%B0%20%D0%BD%D0%B0%20%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%BD%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%B8%D0%BC%D0%B5%D0%BD%D0%B0_files/ga.js"></script><script src="%D0%90%D1%82%D0%B0%D0%BA%D0%B0%20%D0%BA%D0%BB%D0%BE%D0%BD%D0%BE%D0%B2.%20%D0%9E%D0%BC%D0%BE%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F%20%D0%B0%D1%82%D0%B0%D0%BA%D0%B0%20%D0%BD%D0%B0%20%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%BD%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%B8%D0%BC%D0%B5%D0%BD%D0%B0_files/analytics.js" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app225.us.archive.org';v.server_ms=197;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="%D0%90%D1%82%D0%B0%D0%BA%D0%B0%20%D0%BA%D0%BB%D0%BE%D0%BD%D0%BE%D0%B2.%20%D0%9E%D0%BC%D0%BE%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F%20%D0%B0%D1%82%D0%B0%D0%BA%D0%B0%20%D0%BD%D0%B0%20%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%BD%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%B8%D0%BC%D0%B5%D0%BD%D0%B0_files/bundle-playback.js" charset="utf-8"></script>
<script type="text/javascript" src="%D0%90%D1%82%D0%B0%D0%BA%D0%B0%20%D0%BA%D0%BB%D0%BE%D0%BD%D0%BE%D0%B2.%20%D0%9E%D0%BC%D0%BE%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F%20%D0%B0%D1%82%D0%B0%D0%BA%D0%B0%20%D0%BD%D0%B0%20%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%BD%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%B8%D0%BC%D0%B5%D0%BD%D0%B0_files/wombat.js" charset="utf-8"></script>
<script>window.RufflePlayer=window.RufflePlayer||{};window.RufflePlayer.config={"autoplay":"on","unmuteOverlay":"hidden"};</script>
<script type="text/javascript" src="%D0%90%D1%82%D0%B0%D0%BA%D0%B0%20%D0%BA%D0%BB%D0%BE%D0%BD%D0%BE%D0%B2.%20%D0%9E%D0%BC%D0%BE%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F%20%D0%B0%D1%82%D0%B0%D0%BA%D0%B0%20%D0%BD%D0%B0%20%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%BD%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%B8%D0%BC%D0%B5%D0%BD%D0%B0_files/ruffle.js"></script>
<script type="text/javascript">
    __wm.pc(0.001);
    __wm.init("https://web.archive.org/web");
  __wm.wombat("http://www.nobunkum.ru:80/ru/idn","20171014062030","https://web.archive.org/","web","https://web-static.archive.org/_static/",
	      "1507962030");
</script>
<link rel="stylesheet" type="text/css" href="%D0%90%D1%82%D0%B0%D0%BA%D0%B0%20%D0%BA%D0%BB%D0%BE%D0%BD%D0%BE%D0%B2.%20%D0%9E%D0%BC%D0%BE%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F%20%D0%B0%D1%82%D0%B0%D0%BA%D0%B0%20%D0%BD%D0%B0%20%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%BD%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%B8%D0%BC%D0%B5%D0%BD%D0%B0_files/banner-styles.css">
<link rel="stylesheet" type="text/css" href="%D0%90%D1%82%D0%B0%D0%BA%D0%B0%20%D0%BA%D0%BB%D0%BE%D0%BD%D0%BE%D0%B2.%20%D0%9E%D0%BC%D0%BE%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F%20%D0%B0%D1%82%D0%B0%D0%BA%D0%B0%20%D0%BD%D0%B0%20%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%BD%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%B8%D0%BC%D0%B5%D0%BD%D0%B0_files/iconochive.css">
<!-- End Wayback Rewrite JS Include -->

  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>Атака клонов. Омографическая атака на интернационализированные доменные имена</title>
  <!-- base href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/" -->
  <link rel="alternate" type="application/rss+xml" title="Журнал NO BUNKUM — Новости" href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/rss">
  <link rel="stylesheet" type="text/css" href="%D0%90%D1%82%D0%B0%D0%BA%D0%B0%20%D0%BA%D0%BB%D0%BE%D0%BD%D0%BE%D0%B2.%20%D0%9E%D0%BC%D0%BE%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F%20%D0%B0%D1%82%D0%B0%D0%BA%D0%B0%20%D0%BD%D0%B0%20%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%BD%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%B8%D0%BC%D0%B5%D0%BD%D0%B0_files/style.css">
<!--[if lt IE 8]>
<link rel="stylesheet" type="text/css" href="/template/css/ie.css" />
<![endif]-->
<!--[if IE 6]>
<link rel="stylesheet" type="text/css" href="/template/css/ie6.css" />
<![endif]-->
</head>
<body><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display: block; direction: ltr;">
</div><div id="wm-ipp-print">The Wayback Machine - https://web.archive.org/web/20171014062030/http://www.nobunkum.ru:80/ru/idn</div>
<script type="text/javascript">//<![CDATA[
__wm.bt(725,27,25,2,"web","http://www.nobunkum.ru/ru/idn","20171014062030",1996,"https://web-static.archive.org/_static/",["https://web-static.archive.org/_static/css/banner-styles.css?v=S1zqJCYt","https://web-static.archive.org/_static/css/iconochive.css?v=qtvMKcIJ"], false);
  __wm.rw(1);
//]]></script>
<!-- END WAYBACK TOOLBAR INSERT -->
 
      <div class="subscribe">
        
<form action="/web/20171014062030/http://www.nobunkum.ru/ru/idn" method="post">
<div>
<input class="mail" type="text" name="email" placeholder="newsletter">
<input type="hidden" name="groups[]" value="1">
<input class="submit" type="submit" value="OK"></div>
</form>
      </div>
  <div id="header">
    <div id="title">
      <a id="logo" href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/"><img src="%D0%90%D1%82%D0%B0%D0%BA%D0%B0%20%D0%BA%D0%BB%D0%BE%D0%BD%D0%BE%D0%B2.%20%D0%9E%D0%BC%D0%BE%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F%20%D0%B0%D1%82%D0%B0%D0%BA%D0%B0%20%D0%BD%D0%B0%20%D0%B8%D0%BD%D1%82%D0%B5%D1%80%D0%BD%D0%B0%D1%86%D0%B8%D0%BE%D0%BD%D0%B0%D0%BB%D0%B8%D0%B7%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%B4%D0%BE%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5%20%D0%B8%D0%BC%D0%B5%D0%BD%D0%B0_files/logo.jpg" width="374" height="51" alt="NO BUNKUM"></a>
      <p>...on guns, germs, and steel of the digital age</p>
    </div>
    <div id="subtitle">
      <ul><li class="first"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/lookout/" title="Lookout" class="issue">Lookout</a></li>
<li><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/analytics/" title="Analytics" class="issue">Analytics</a></li>
<li class="current"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/ru/" title="NO BUNKUM" class="issue">NO BUNKUM</a></li>
<li class="last"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/demo/" title="Demo" class="issue">Demo</a></li>
</ul>
      <div class="headerlinks">
        <a id="headerlink-about" href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/about" title="О журнале"><span>?</span></a>
        <a id="headerlink-rss" href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/rss" title="RSS"><span>RSS</span></a>
      </div>
    </div>
  </div>
  <div id="content">
    <div class="aside-long" style="text-align:center;padding:15px 10px">
      <span class="tl-tag tl-tag-weight1"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=Exploit.SWF.Agent.br">Exploit.SWF.Agent.br</a></span>
<span class="tl-tag tl-tag-alt tl-tag-weight1"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=Pdfka.asd">Pdfka.asd</a></span>
<span class="tl-tag tl-tag-weight1"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=Pidief.cvl">Pidief.cvl</a></span>
<span class="tl-tag tl-tag-alt tl-tag-weight2"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=TDSS">TDSS</a></span>
<span class="tl-tag tl-tag-weight1"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=TDSS+removal">TDSS removal</a></span>
<span class="tl-tag tl-tag-alt tl-tag-weight1"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=binary+planting">binary planting</a></span>
<span class="tl-tag tl-tag-weight1"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=bios+infection">bios infection</a></span>
<span class="tl-tag tl-tag-alt tl-tag-weight1"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=blind+sqli">blind sqli</a></span>
<span class="tl-tag tl-tag-weight1"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=bootkit">bootkit</a></span>
<span class="tl-tag tl-tag-alt tl-tag-weight1"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=bootkit+remover">bootkit remover</a></span>
<span class="tl-tag tl-tag-weight1"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=browser+exploitation">browser exploitation</a></span>
<span class="tl-tag tl-tag-alt tl-tag-weight1"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=com+hijacking">com hijacking</a></span>
<span class="tl-tag tl-tag-weight4"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=disassembling">disassembling</a></span>
<span class="tl-tag tl-tag-alt tl-tag-weight1"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=dll+hijacking">dll hijacking</a></span>
<span class="tl-tag tl-tag-weight2"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=drive-by+downloads">drive-by downloads</a></span>
<span class="tl-tag tl-tag-alt tl-tag-weight1"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=hack+online+banks">hack online banks</a></span>
<span class="tl-tag tl-tag-weight1"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=heap-spray">heap-spray</a></span>
<span class="tl-tag tl-tag-alt tl-tag-weight1"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=hijack+botnet">hijack botnet</a></span>
<span class="tl-tag tl-tag-weight1"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=ibank">ibank</a></span>
<span class="tl-tag tl-tag-alt tl-tag-weight1"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=kernel+protection">kernel protection</a></span>
<span class="tl-tag tl-tag-weight1"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=kernel-mode+rootkit">kernel-mode rootkit</a></span>
<span class="tl-tag tl-tag-alt tl-tag-weight1"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=keylogger">keylogger</a></span>
<span class="tl-tag tl-tag-weight5"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=malware+analysis">malware analysis</a></span>
<span class="tl-tag tl-tag-alt tl-tag-weight2"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=rootkit+detection">rootkit detection</a></span>
<span class="tl-tag tl-tag-weight3"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=trojan">trojan</a></span>
<span class="tl-tag tl-tag-alt tl-tag-weight1"><a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/tags?tag=virus+removal">virus removal</a></span>
    </div>
    <div id="content_text" style="margin-top: -10px;">
<div id="content_title"><h1>Атака клонов. Омографическая атака на интернационализированные доменные имена.</h1></div>
<div id="article_author" class="author">Алексей Фельдгендлер <br>разработчик Opera Software<br><a href="https://web.archive.org/web/20171014062030/mailto:alexey@feldgendler.ru">alexey@feldgendler.ru</a></div><br>

<div style="padding-left: 14px;">
<a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/ru/idn#idn">Как работает IDN</a><br>
<a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/ru/idn#new">Старая атака с новыми возможностями</a><br>
<a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/ru/idn#counter">Противодействие омографической атаке</a><br>
<a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/ru/idn#outro">Заключение</a><br>
<a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/ru/idn#reference">Список ссылок</a><br>
</div>
<br>

Во многих разделах информационных технологий мы были свидетелями схожих 
путей развития. Сначала что-нибудь становится возможным для латинского 
алфавита, а затем технология расширяется для поддержки других систем 
письменности, зачастую ценой значительного усложнения. Сегодня мы можем 
включать, например, кириллицу в электронные письма, SMS-сообщения, имена 
файлов. Технологии, делающие это возможным, часто разрабатываются как 
надстройки над существующими стандартами, поддерживающими только ASCII. 
Увы, добавляемый при этом новый уровень сложности может открывать новые 
возможности для злоупотреблений. Не исключение и новшество XXI века - 
интернационализированные доменные имена (IDN). 
<br><br>

В статье пойдёт речь о так называемой омографической атаке на эту 
технологию.  Омографическая атака, суть которой заключается в 
использовании сходства доменных имен с целью введения пользователя в 
заблуждения - давно известная технология фишинга. Мы покажем, как новые 
возможности, предоставляемые IDN, делают омографическую атаку особенно 
опасной, и опишем, какие меры противодействия принимают администрации 
доменов верхнего уровня и производители браузеров. 

<a id="a_title" name="idn" style="text-decoration: none;"><h2>Как работает IDN</h2></a> 

IDN (internationalized domain names) - это доменные имена, которые могут 
содержать другие алфавитные символы, помимо базовой латиницы<a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/ru/idn#reference">[1]</a>. 
Возможность регистрировать домены с такими именами важна прежде всего для 
носителей языков, чьи системы письменности не основаны на латинице, 
например, русского или китайского. Но и дополнения к базовой латинице 
употребляются во многих европейских языках: например, в 2004 году 
норвежская сеть магазинов Elkjøp зарегистрировала домен elkjøp.no. Первым 
доменом верхнего уровня, где стала возможна регистрация IDN, стал .jp, 
разрешивший в 2003 году использовать в доменных именах символы японской 
письменности. 
<br><br>
Протокол DNS<a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/ru/idn#reference">[2]</a>, регламентирующий запросы к серверам доменных имён и 
ответы на них, - пожалуй, наиболее широко распространённый в Интернете. 
Поскольку существующая инфраструктура доменных имён рассчитана на работу 
только с набором символов ASCII, добавить ко всем серверам поддержку 
Unicode не представляется возможным. Поэтому пришлось разработать такую 
технологию, которая кодирует имена, пользуясь только символами ASCII. 
Например, домен elkjøp.no «на самом деле» зарегистрирован как 
<nobr>xn--elkjp-yua.no</nobr>. Такая запись доменного имени называется Punycode<a href="#reference">[3]</a>. ASCII-запись интернационализированных доменных 
имён начинается  
префиксом «xn--», чтобы показать, что в имени используется Punycode 
(обычно два дефиса подряд в доменном имени запрещены). В таком виде имя 
неприглядно, но может использоваться даже с программным обеспечением, 
написанным до появления IDN. 

<br><br>
Когда мы набираем в адресной строке доменное имя, содержащее символы вне 
ASCII, браузер преобразует имя в Punycode и в таком виде использует в 
запросах к доменным и HTTP-серверам. Аналогично, если браузер 
перенаправлен на адрес <nobr>http://xn--l-4ga.no</nobr>, он покажет в адресной строке 
понятное пользователю <nobr>«http://øl.no»</nobr>. 
<br><br>
Сама по себе кодировка Punycode не накладывает ограничений на входные 
данные и может применяться для кодирования любой последовательности 
символов Unicode. Поэтому перед кодированием доменные имена проходят 
процедуру Nameprep<a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/ru/idn#reference">[4]</a>, которая приводит текст к нижнему регистру и 
удаляет некоторые невидимые символы, например, пробелы нулевой ширины и 
мягкие переносы. Кроме того, в ходе этой процедуры составные символы 
нормализуются, то есть приводятся к одной, строго определённой форме 
кодирования, а именно Unicode normalization form KC. Так, 
последовательность кодов U+0041 (A) и U+030A (кружок-комбинатор) 
превращается в символ U+00C5 (Å). В него же превращается и символ U+212B 
(знак ангстрема), выглядящий точно так же. 
<br><br>
Процедура Nameprep определена именно так для того, чтобы пресечь опасное 
злоупотребление: регистрацию доменных имён, внешне неотличимых друг от 
друга, но технически различных. Отправив по электронной почте ссылку на 
такой домен с «альтернативным» написанием имени, злоумышленник мог бы 
заманить жертву на сайт-имитацию. (Как мы увидим далее, 
Unicode-нормализации, включённой в Nameprep, недостаточно для полного 
исключения этого вида мошенничества.) Кроме того, Unicode содержит 
некоторые невидимые управляющие символы, например, маркер смены 
направления, задающий общее направление письма в тексте - слева направо 
или справа налево. Включение злоумышленником в состав доменного имени 
этого и других подобных управляющих символов могло бы позволить ему 
получить некоторую степень опасного контроля над отображением доменного 
имени в браузере. Поэтому важно, чтобы после обратного преобразования из 
Punycode в Unicode браузер удалял из строки все такие символы, ведь 
злоумышленник мог и не применять к своей исходной строке процедуру 
Nameprep. 

<br><br>
Все современные браузеры поддерживают интернационализированные доменные 
имена: Firefox с версии 1.4, Opera с версии 7.11, Safari с версии 1.2, 
Internet Explorer с версии 7.0 (существует также дополнение к версии 6.0 
для поддержки IDN). Поддержка IDN в браузере состоит из двух частей: 
преобразования имени из Unicode в ASCII при вводе и преобразования из 
ASCII в Unicode при отображении. Первая часть не несёт никакой угрозы. 
Браузер, в котором было бы реализовано только преобразование из Unicode в 
ASCII, позволял бы посещать сайты с нелатинскими именами, которые набирает 
пользователь, но отображал бы их в нечитаемой кодировке Punycode. Именно 
поддержка обратного преобразования представляет собой слабое место, 
уязвимое для различных атак. Например, после декодирования может 
оказаться, что результат содержит невидимые управляющие символы, прописные 
буквы (которые процедура «Nameprep» преобразует в строчные) или 
неканонические формы кодирования букв с диакритическими знаками. К 
счастью, всё это легко отсеять автоматически. Так, например, современные 
браузеры откажутся декодировать адрес <nobr>http://xn--l-bfa.no</nobr> в строку 
<nobr>«http://Øl.no»</nobr>: прописная буква «Ø» должна была превратиться в строчную, 
что дало бы ASCII-форму <nobr>http://xn--l-4ga.no</nobr>, следовательно, мы имеем дело 
с мошенническим сайтом, владелец которого пытается выдать его за настоящий 
«øl.no». 


<a id="a_title" name="new" style="text-decoration: none;"><h2>Старая атака с новыми возможностями</h2></a> 

Атакам, основанным на внешнем сходстве доменных имён, не первый десяток 
лет. Общий сценарий атаки таков: злоумышленник регистрирует доменное имя, 
сходное по написанию с атакуемым доменом, организует на подставном домене 
более или менее реалистичную копию сайта-оригинала и распространяет ссылки 
на домен, например, посредством спама, имитирующего почтовые уведомления, 
рассылаемые сайтом. Целью атаки может быть сбор паролей и персональной 
информации, а также слежение за пользователями. Особенностью атаки, 
основанной на сходстве доменных имён, по сравнению с другими видами 
фишинга с использованием подставных веб-страниц является то, что для неё 
не требуется вмешательство в работу сетевых протоколов: с технической 
точки зрения подставной домен вполне легитимный.  
<br><br>
Обычно для таких атак используется сходство букв с цифрами в некоторых 
шрифтах (буква «l» и цифра 1, буква «O» и цифра 0), сходство сочетаний 
букв («rn» и «m», «cl» и 

«d»), «незаметность» точки 
(«wwwpaypal.com») и даже «рябь в глазах» от 
повторяющихся элементов («paypapal.com»). При  
внимательном рассмотрении адресной строки, особенно при использовании 
шрифтов, избегающих опасного сходства символов, все эти приёмы нетрудно 
распознать. Тем не менее, данный метод остаётся весьма успешным. Для 
противодействия ему некоторые крупные веб-сервисы превентивно регистрируют 
очевидные варианты ошибочного написания своих имён. Так, например, домен 
paypa1.com (с единицей вместо последней буквы) был зарегистрирован в 2000 
году в пользу PayPal Inc компанией MarkMonitor, специализирующейся на 
охране торговых марок. Кроме того, в последнее время пользователям всё 
чаще советуют не щёлкать по ссылкам, полученным по электронной почте, а 
набирать адреса вручную. Впрочем, поскольку веб-сервисы продолжают 
включать удобные ссылки в рассылаемые почтовые уведомления, остаётся 
только догадываться, какая часть пользователей следует этому совету. 
<br><br>
Интернационализированные доменные имена приносят в старый сценарий новые 
возможности. Поскольку в таких именах можно использовать буквы различных 
алфавитов, злоумышленник может заменить одну или несколько букв доменного 
имени их омографами - идентично или почти идентично выглядящими буквами 
другого алфавита. Поскольку и латиница, и кириллица исторически происходят 
от греческого алфавита, неудивительно, что, к примеру, во всех трёх из них 
есть буква «o». С точки зрения человеческого глаза это одна и та же буква, 
а с точки зрения Unicode - три разных. Во многих шрифтах они выглядят 
совершенно одинаково, поэтому маскировочный потенциал омографов намного 
выше, чем у «опечаток». 

<br><br>
Атаку с использованием IDN-омографов впервые описали в 2001 году Евгений 
Габрилович и Алекс Гонтмахер из израильского технологического института 
Технион<a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/ru/idn#reference">[5]</a>. Однако первый известный случай успешной атаки по 
этому методу был предан огласке только в 2005 году на хакерской 
конференции Shmoocon. Тогда хакерам удалось зарегистрировать подставной 
домен pаypal.com (xn--pypal-4ve.com в Punycode), где первая буква «а» - 
кириллическая<a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/ru/idn#reference">[6]</a>. Благодаря публикации на Slashdot.org к проблеме 
было привлечено внимание общественности, вскоре после чего как браузеры, 
так и администрации многих доменов верхнего уровня выработали и 
реализовали контрмеры. 
<br><br>
Наиболее богатые возможности для омографической атаки предоставляет 
кириллица. Буквы «а», «с», 
«е», «і», «ј», 
«о», «р», «ѕ», 

«х» и «у»  
(некоторые из них относятся к вариантам кириллицы, используемым в 
болгарском, сербском и других языках) похожи на строчные латинские буквы, 
а «З», «Ч» и 
«б»  - на цифры. В греческом алфавите точную имитацию 
латиницы из строчных обеспечивают только буквы «ο» и «ν», но использование 
прописных сильно расширяет набор. Некоторые другие греческие буквы 
(«α», «η», «ι», 
«ρ», «υ», «χ») 
похожи на латинские, но имеют видимые отличия.  
Ещё несколько отдельных возможностей предоставляют иврит и армянский 
алфавит. Наконец, если имя самого атакуемого домена - IDN, - то немецкую 
лигатуру «ß» можно сымитировать греческой буквой «β», а буквы расширенной 
латиницы «ë» и «ï» - похожими символами кириллицы. 

<br><br>
Итак, у большинства гласных и у некоторых согласных латинского алфавита 
есть омографы, главным образом в кириллице. Использование омографов вместо 
части букв латиницы, входящих в доменное имя, порождает множество 
смешанных имён. С ростом длины доменного имени число возможных 
омографических имитаций возрастает экспоненциально, а значит, так же 
растёт и дороговизна превентивной скупки похожих доменных имён самим 
владельцем популярного домена. Так, для paypal.com возможно 31 
альтернативное написание (без привлечения единицы вместо буквы «l»), для 
livejournal.com - 95 (учитывая возможность использования греческих 
«ο» и «ν», для moneysupermarket.com 
- 383, для computerandvideogames.com - 9215 (!). 
<br><br>
Омографическая атака с использованием IDN опаснее обычного фишинга, 
основанного на сходстве доменных имён, так как, во-первых, IDN-омографы 
могут быть совершенно неотличимы от оригинала, а, во-вторых, использование 
IDN порождает экспоненциальный рост числа возможных вариантов доменного 
имени при увеличении его длины. Проблема усугубляется сравнительной 
новизной технологии, а также тем, что как веб-мастера, так и пользователи 
могут не обладать достаточными знаниями об иностранных языках, чтобы 
распознать угрозу. 
<br><br>
Отдельно следует заметить, что в китайской, японской и корейской 
письменности существует похожая проблема: один и тот же символ иногда 
имеет несколько альтернативных написаний, которые считаются отдельными 
символами Unicode. Например, китайские иероглифы U+6559 (教) и U+654E (敎), 
обозначающие «учить», «учение», логически взаимозаменяемы. Замена одного 
такого символа другим может породить имя, трудноотличимое от оригинала для 
носителя языка. Аналогично, некоторые символы персидского языка, 
письменность которого основана на арабской, слегка отличаются от 
соответствующих арабских форм и предоставляют некоторый потенциал для 
маскировки подставных доменов. 


<a id="a_title" name="counter" style="text-decoration: none;"><h2>Противодействие омографической атаке</h2></a> 

При атаках, основанных на сходстве доменных имён,  владелец подлинного 
сайта практически лишён возможностей к обороне, за исключением совета 
своим пользователям никогда не щёлкать по ссылкам в электронной почте. 
Поэтому ответственность за предотвращение злоупотреблений лежит на 
производителях браузеров и регистраторах доменов. 
<br><br>
Наиболее радикальным вариантом защиты против омографической угрозы был бы 
полный отказ от декодирования IDN при отображении. Тогда подставное имя 
всегда начиналось бы с «xn» и заканчивалось нечитаемой последовательностью 
символов, что резко отличало бы его от оригинала. К сожалению, этот 
вариант сводит на нет практически все преимущества IDN. 
<br><br>
Браузер мог бы реализовывать ту или иную эвристику, призванную отличить 
возможное злоупотребление. Например, разумным представляется отказ от 
декодирования имён, содержащих символы разных алфавитов вплотную друг к 
другу, и отображение таких имён в виде Punycode. Однако эвристика 
неизбежно давала бы иногда как ложнонегативные результаты (разрешение 
злоупотреблений), так и ложнопозитивные (запрет легитимных имён). 
Последние особенно опасны: если пользователь привыкнет к тому, что имена 
некоторых легитимных доменов отображаются в виде «каши» из латиницы и 
цифр, то появление в адресной строке других Punycode-последовательностей 
легко сможет пройти незамеченным, так как для человеческого глаза все 
бессмысленные цепочки символов выглядят похоже друг на друга. С другой 
стороны, некоторые имена можно сымитировать одними только символами 
кириллицы, без смешения алфавитов. 
<br><br>
Администрации многих доменов верхнего уровня<a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/ru/idn#reference">[7]</a>, со своей стороны, 
решили противостоять омографическим атакам путём введения ограничений на 
регистрируемые имена. Задача, стоящая перед администрацией 
государственного домена верхнего уровня (ccTLD), такого, как .de, 
облегчается тем, что такой домен вполне разумно считать предназначенным 
для регистрации названий на национальном языке страны. Так, например, 
домен .no разрешает использование букв «æ», 

«ø», «å», используемых в  
норвежском языке, а также некоторых других символов расширенной латиницы, 
встречающихся в прочих языках Скандинавии. Обычно домены верхнего уровня в 
странах, пользующихся латинским алфавитом, ограничивают репертуар 
разрешённых символов тем или иным подмножеством расширенной латиницы. Так 
же поступает международный домен .org. Такой подход в целом безопасен, 
поскольку среди символов расширенной латиницы нет точных омографов. 
<br><br>
В несколько особенных условиях находится греческий домен .gr. В нём 
разрешены имена из произвольной смеси латинского и греческого алфавитов, 
однако при регистрации любого имени все омографы этого имени автоматически 
становятся недоступными для регистрации кому-либо, кроме владельца 
зарегистрированного домена. Иными словами, пространство имён разделено на 
классы омографической эквивалентности, и имена в одном таком классе не 
могут принадлежать разным владельцам. Аналогичный подход практикуют 
китайский домен .cn, тайваньский .tw, японский .jp и корейский .kr в 
отношении омографических написаний внутри дальневосточных языков. Для 
противодействия злоупотреблениям доменными именами на этих языках группа 
Joint Engineering Team (JET) разработала свод правил, принятых на 
вооружение администрациями упомянутых доменов<a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/ru/idn#reference">[8]</a>. 
<br><br>
Интересный подход избрала администрация иранского домена .ir: доменные 
имена непосредственно в домене .ir могут содержать только символы ASCII, а 
для имён на персидском создан специальный поддомен 
.ایران.ir  («Иран.ir»),  
где латиница запрещена. Кроме того, при регистрации доменного имени на 
персидском языке на имя заказчика автоматически регистрируется до шести 
вариантов, получаемых заменой персидских букв «ک» 
и «ی» арабскими аналогами. 
<br><br>
Тайский домен .th разрешает как базовую латиницу, так и символы тайского 
языка, поскольку никакая их смесь не может представлять омографической 
опасности. Болгарский домен .bg разрешает имена, состоящие либо только из 
кириллицы, либо только из латиницы, причём кириллическое имя обязано 
содержать хотя бы одну букву, не имеющую омографа в латинице (например, 

&lt;я&gt;). 
<br><br>
Международный домен .biz разрешает, помимо латиницы, символы китайского, 
японского и корейского языков, однако они не представляют опасности с 
точки зрения возможности омографической имитации латиницы. Заказчику 
предлагается выбрать один из 15 разрешённых языков, а затем указать имя, 
полностью состоящее из символов, разрешённых для выбранного языка. Похожую 
политику применяет и международный домен .info. Польский домен .pl - один 
из самых либеральных, - руководствуется подобными правилами и разрешает и 
кириллицу, и греческий алфавит, и даже иврит. 
<br><br>
После определённого периода, в течение которого в домене .ru можно было 
зарегистрировать кириллический домен, Координационный центр национального 
домена сети Интернет (<nobr>http://cctld.ru</nobr>) ограничил набор допустимых символов 
латинскими буквами, цифрами и дефисом. Для регистрации русскоязычных имён 
предназначен новый домен верхнего уровня .рф, который уже утверждён ICANN 
и будет делегирован в апреле 2010 года. Сейчас организациям доступна 
возможность предварительной регистрации имён в этом домене. Особенностью 
домена .рф является то, что имена в нём могут состоять только из 
кириллицы, цифр и дефисов - латиница запрещена. Само имя домена .рф было 
выбрано так, чтобы избежать омографии с другими доменами верхнего уровня - 
по этой причине не были приняты варианты «.ро» и «.ру». Домен .рф стал 
одним из первых интернационализированных доменов верхнего уровня, 
одобренных ICANN, вскоре после египетского домена .مصر («Египет»). На 
очереди заявки на создание болгарского домена .бг и украинского .укр. 
<br><br>

В таблице приведён список доменов верхнего уровня, администрации которых 
противодействуют омографической атаке (автор приносит извинения за 
возможную неполноту списка). К сожалению, многие домены по-прежнему 
разрешают регистрацию любых имён без ограничений. Особенно прискорбно, что 
контрмерами до сих пор не озаботилась американская компания VeriSign, 
администрирующая самый крупный в мире домен верхнего уровня .com, а также 
популярные домены .net, .tv, .name, .cc и .jobs. Не приведены также такие 
домены, как .me и .ru, полностью запрещающие регистрацию IDN и этим 
исключающие возможность омографической атаки. 
<br><br>
<table width="100%" border="1" bordercolor="#000000" cellpadding="4" cellspacing="0">
	<colgroup><col width="85*">
	<col width="85*">
	<col width="85*">
	</colgroup><tbody><tr valign="TOP">
		<th width="33%">
			<p>Домен</p>
		</th>

		<th width="33%">
			<p>Страна</p>
		</th>
		<th width="33%">
			<p>Правила</p>
		</th>
	</tr>
	<tr valign="TOP">

		<td width="33%">
			<p>.ac</p>
		</td>
		<td width="33%">
			<p>Остров Вознесения</p>
		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>

		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.ar</p>
		</td>
		<td width="33%">
			<p>Аргентина</p>

		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.at</p>

		</td>
		<td width="33%">
			<p>Австрия</p>
		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>
		</td>
	</tr>

	<tr valign="TOP">
		<td width="33%">
			<p>.bg</p>
		</td>
		<td width="33%">
			<p>Болгария</p>
		</td>
		<td width="33%">

			<p>Только латиница либо только кириллица (кириллическое имя должно
			содержать хотя бы одну букву, не имеющую латинского омографа)</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.biz</p>
		</td>
		<td width="33%">

			<p>Международный</p>
		</td>
		<td width="33%">
			<p>Выбор из 15 языков</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">

			<p>.br</p>
		</td>
		<td width="33%">
			<p>Бразилия</p>
		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>

		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.cat</p>
		</td>
		<td width="33%">
			<p>Каталанское языковое сообщество</p>

		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.ch</p>

		</td>
		<td width="33%">
			<p>Швейцария</p>
		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>
		</td>
	</tr>

	<tr valign="TOP">
		<td width="33%">
			<p>.cl</p>
		</td>
		<td width="33%">
			<p>Чили</p>
		</td>
		<td width="33%">

			<p>Только расширенная латиница</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.cn</p>
		</td>
		<td width="33%">

			<p>Китай</p>
		</td>
		<td width="33%">
			<p>Латиница и китайский, защита от регистрации омографов разными
			заказчиками (правила JET)</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">

			<p>.de</p>
		</td>
		<td width="33%">
			<p>Германия</p>
		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>

		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.dk</p>
		</td>
		<td width="33%">
			<p>Дания</p>

		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.es</p>

		</td>
		<td width="33%">
			<p>Испания</p>
		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>
		</td>
	</tr>

	<tr valign="TOP">
		<td width="33%">
			<p>.eu</p>
		</td>
		<td width="33%">
			<p>Евросоюз</p>
		</td>
		<td width="33%">

			<p>Только расширенная латиница, либо только кириллица, либо только
			греческий</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.fi</p>
		</td>
		<td width="33%">

			<p>Финляндия</p>
		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">

			<p>.gr</p>
		</td>
		<td width="33%">
			<p>Греция</p>
		</td>
		<td width="33%">
			<p>Латиница и греческий, защита от регистрации омографов разными
			заказчиками</p>

		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.hk</p>
		</td>
		<td width="33%">
			<p>Гонконг</p>

		</td>
		<td width="33%">
			<p>Латиница и китайский, защита от регистрации омографов разными
			заказчиками (правила JET)</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.hu</p>

		</td>
		<td width="33%">
			<p>Венгрия</p>
		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>
		</td>
	</tr>

	<tr valign="TOP">
		<td width="33%">
			<p>.info</p>
		</td>
		<td width="33%">
			<p>Международный</p>
		</td>
		<td width="33%">

			<p>Выбор из 10 языков</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.io</p>
		</td>
		<td width="33%">

			<p>Британская территория в Индийском океане</p>
		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">

			<p>.ir</p>
		</td>
		<td width="33%">
			<p>Иран</p>
		</td>
		<td width="33%">
			<p>Только ASCII в домене .ir, только персидские символы в
			поддомене .<font face="Bitstream Vera Sans"><span lang="zxx">ایران</span></font>.ir
			(«Иран.ir»), автоматическая регистрация арабских
			омографов на имя владельца домена</p>

		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.is</p>
		</td>
		<td width="33%">
			<p>Исландия</p>

		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.jp</p>

		</td>
		<td width="33%">
			<p>Япония</p>
		</td>
		<td width="33%">
			<p>Латиница и японский, защита от регистрации омографов разными
			заказчиками (правила JET)</p>
		</td>
	</tr>

	<tr valign="TOP">
		<td width="33%">
			<p>.kr</p>
		</td>
		<td width="33%">
			<p>Корея</p>
		</td>
		<td width="33%">

			<p>Латиница и корейский, защита от регистрации омографов разными
			заказчиками (правила JET)</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.li</p>
		</td>

		<td width="33%">
			<p>Лихтенштейн</p>
		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>
		</td>
	</tr>
	<tr valign="TOP">

		<td width="33%">
			<p>.lt</p>
		</td>
		<td width="33%">
			<p>Литва</p>
		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>

		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.lv</p>
		</td>
		<td width="33%">
			<p>Латвия</p>

		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.museum</p>

		</td>
		<td width="33%">
			<p>Международный</p>
		</td>
		<td width="33%">
			<p>Только расширенная латиница либо только иврит</p>
		</td>
	</tr>

	<tr valign="TOP">
		<td width="33%">
			<p>.no</p>
		</td>
		<td width="33%">
			<p>Норвегия</p>
		</td>
		<td width="33%">

			<p>Только расширенная латиница</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.nu</p>
		</td>
		<td width="33%">

			<p>Ниуэ</p>
		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">

			<p>.org</p>
		</td>
		<td width="33%">
			<p>Международный</p>
		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>

		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.pe</p>
		</td>
		<td width="33%">
			<p>Перу</p>

		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.pl</p>

		</td>
		<td width="33%">
			<p>Польша</p>
		</td>
		<td width="33%">
			<p>Выбор из 37 языков</p>
		</td>
	</tr>

	<tr valign="TOP">
		<td width="33%">
			<p>.pr</p>
		</td>
		<td width="33%">
			<p>Пуэрто-Рико</p>
		</td>
		<td width="33%">

			<p>Только расширенная латиница</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.sa</p>
		</td>
		<td width="33%">

			<p>Саудовская Аравия</p>
		</td>
		<td width="33%">
			<p>Латиница и арабский (нет омографии)</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">

			<p>.se</p>
		</td>
		<td width="33%">
			<p>Швеция</p>
		</td>
		<td width="33%">
			<p>Только расширенная латиница либо только иврит</p>

		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.sh</p>
		</td>
		<td width="33%">
			<p>Остров Святой Елены</p>

		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.th</p>

		</td>
		<td width="33%">
			<p>Таиланд</p>
		</td>
		<td width="33%">
			<p>Латиница и тайский (нет омографии)</p>
		</td>
	</tr>

	<tr valign="TOP">
		<td width="33%">
			<p>.tm</p>
		</td>
		<td width="33%">
			<p>Туркменистан</p>
		</td>
		<td width="33%">

			<p>Только расширенная латиница</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.tw</p>
		</td>
		<td width="33%">

			<p>Тайвань</p>
		</td>
		<td width="33%">
			<p>Латиница и китайский, защита от регистрации омографов разными
			заказчиками (правила JET)</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">

			<p>.ve</p>
		</td>
		<td width="33%">
			<p>Венесуэла</p>
		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>

		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.vn</p>
		</td>
		<td width="33%">
			<p>Вьетнам</p>

		</td>
		<td width="33%">
			<p>Только расширенная латиница</p>
		</td>
	</tr>
	<tr valign="TOP">
		<td width="33%">
			<p>.рф</p>

		</td>
		<td width="33%">
			<p>Россия</p>
		</td>
		<td width="33%">
			<p>Только кириллица</p>
		</td>
	</tr>

	<tr valign="TOP">
		<td width="33%">
			<p>.<font face="Bitstream Vera Sans"><span lang="zxx">مصر</span></font></p>
		</td>
		<td width="33%">
			<p>Египет</p>
		</td>
		<td width="33%">

			<p>Только арабский</p>
		</td>
	</tr>
</tbody></table>
<br>

Поскольку не все администрации доменов верхнего уровня ограждают 
пользователей от омографических атак, производители браузеров вынуждены 
держать второй рубеж обороны. Реализованные в современных браузерах 
решения представляют собой различные компромиссные варианты между 
безопасностью и нуждами международного сообщества. Браузеры Firefox и 
Opera используют белый список доменов верхнего уровня, проводящих 
политику, препятствующую омографическим атакам. Если домен верхнего уровня 
не входит в этот список, то интернационализированные доменные имена в нём 
отображаются в форме Punycode. Это, в частности, означает, что 
интернационализированные имена в домене .com отображаются как Punycode. 
Увидев в адресной строке «xn--pypal-4ve.com» вместо «paypal.com», 
пользователь легко распознает подмену. Ведёт белый список Mozilla 
Foundation<a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/ru/idn#reference">[9]</a>. 

<br><br>
Internet Explorer применяет вместо белого списка эвристику и запрещает 
имена из смеси символов разных алфавитов, не разделённых точкой, с 
исключениями для языков, где такое смешение обычно. Следует заметить, что 
эта эвристика не защищает от атаки, при которой доменное имя полностью 
набирается кириллическими омографами («axe.com»). 
<br><br>
Safari позволяет настраивать список алфавитов, разрешённых к отображению в 
составе IDN; кириллица и греческий алфавит в этот список по умолчанию не 
входят. Хотя это решение обезопасило американских и многих европейских 
пользователей, оно не решает проблему, в частности, для русскоязычных 
пользователей, оставляя их либо уязвимыми, либо без возможности 
пользоваться доменами с именами на родном языке. 

<br><br>
Теоретически, меры противодействия, реализованные в браузерах, - 
временные. Когда все домены верхнего уровня станут пресекать регистрацию 
опасных имён, эти меры станут не нужны. Однако как скоро это произойдёт, 
предсказать трудно. Особенно сложная задача по выработке безопасной 
политики стоит перед компанией VeriSign, поскольку домен .com и другие 
домены верхнего уровня, которые она администрирует, - международные и 
должны удовлетворять потребности заказчиков изо всех стран мира. 

<a id="a_title" name="outro" style="text-decoration: none;"><h2>Заключение</h2></a> 

Омографическая атака основана на эксплуатации возможности включать в 
доменные имена символы Unicode по технологии IDN. Злоумышленник может 
зарегистрировать подставной домен, отличающийся от оригинала заменой 
латинской буквы сходной по написанию буквой другого алфавита, чаще всего 
кириллицы. Поскольку такое доменное имя может быть внешне неотличимо от 
оригинала, метод предоставляет богатые возможности для фишинга. 
<br><br>
Администрации многих доменов верхнего уровня проводят политику, 
препятствующую регистрации доменных имён, которые могут быть использованы 
для омографической атаки. Тем не менее, домен .com и многие другие 
популярные домены по-прежнему допускают регистрацию имён-омографов, 
поэтому современные браузеры реализуют те или иные меры для недопущения 
отображения таких имён в угодном злоумышленнику виде. 

<a id="a_title" name="reference" style="text-decoration: none;"><h2>Список ссылок</h2></a>                             

1. RFC3490. P. Faltstrom, P. Hoffman, A. Costello. <a href="https://web.archive.org/web/20171014062030/http://www.rfc-editor.org/rfc/rfc3490.txt">Internationalizing Domain 
Names in Applications (IDNA)</a>, 2003<br>

2. RFC1034. P. Mockapetris. <a href="https://web.archive.org/web/20171014062030/http://www.rfc-editor.org/rfc/rfc1034.txt">Domain Names - Concepts 
and Facilities</a>, 1987 <br>
3. RFC3492. A. Costello. <a href="https://web.archive.org/web/20171014062030/http://www.rfc-editor.org/rfc/rfc3492.txt">Punycode: A Bootstring encoding of 
Unicode for Internationalized Domain Names in Applications (IDNA)</a>, 
2003<br>
4. RFC3491. P. Hoffman, M. Blanchet. <a href="https://web.archive.org/web/20171014062030/http://www.rfc-editor.org/rfc/rfc3491.txt">Nameprep: A Stringprep 
Profile for Internationalized Domain Names (IDN)</a>, 2003<br>
5. E. Gabrilovich, A. Gontmakher. <i>The Homograph Attack, 
Communications of the ACM</i>, 45(2):128, 2002<br>
6. E. Johanson. <a href="https://web.archive.org/web/20171014062030/http://www.shmoo.com/idn/homograph.txt">The State of Homograph Attacks</a>, 
2005<br>

7. <a href="https://web.archive.org/web/20171014062030/http://www.iana.org/domains/idn-tables/">Internet Assigned Numbers Authority. Repository of 
IDN Practices</a>, 2010 <br>
8. RFC3743. K. Konishi, K. Huang, H. Qian, Y. Ko. <a href="https://web.archive.org/web/20171014062030/http://www.rfc-editor.org/rfc/rfc3743.txt">Joint 
Engineering Team (JET) Guidelines for Internationalized Domain Names (IDN) 
Registration and Administration for Chinese, Japanese, and Korean</a>, 
2004 <br>
9. Mozilla Foundation. <a href="https://web.archive.org/web/20171014062030/http://www.mozilla.org/projects/security/tld-idn-policy-list.html">IDN-enabled 
TLDs</a>, 2010<br>
<p class="author" style="padding-left: 0px;"><br>Last updated: 17.03.2012</p>
</div>
  ﻿</div>
  <div id="footer">
    <p class="copyright">© 2009–2012 <a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/">NOBUNKUM</a> by <a href="https://web.archive.org/web/20171014062030/http://www.esagelab.ru/">Esage Lab</a> &nbsp;&nbsp;&nbsp;&nbsp;<a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/ru/">/на русском языке</a> <a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/about">/about</a> <a href="https://web.archive.org/web/20171014062030/http://www.nobunkum.ru/rss">/rss</a></p>
  </div>
  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-3546318-9']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://web.archive.org/web/20171014062030/https://ssl' : 'https://web.archive.org/web/20171014062030/http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>


</body></html>
<!--
     FILE ARCHIVED ON 06:20:30 Oct 14, 2017 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 12:22:09 May 30, 2024.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  captures_list: 0.634
  exclusion.robots: 0.22
  exclusion.robots.policy: 0.212
  esindex: 0.008
  cdx.remote: 6.474
  LoadShardBlock: 64.913 (3)
  PetaboxLoader3.datanode: 90.569 (4)
  load_resource: 100.358
  PetaboxLoader3.resolve: 54.648
-->